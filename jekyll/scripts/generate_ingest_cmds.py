# Path to files
path = "../../RawDocx/20250906/"

# To get filenames run this in directory with files
#  % for x in *; do echo \"$x\"\,; done | xargs -0
files = [
    "CBF #510829.docx",
    "CBF #521007.docx",
    "CBF #521015.docx",
    "CBF #521016.docx",
    "CBF #521021.docx",
    "CBF #521022.docx",
    "CBF #521023.docx",
    "CBF #521024.docx",
    "CBF #521027.docx",
    "CBF #521030.docx",
    "CBF #521031.docx",
    "CBF #521103.docx",
    "CBF #521106.docx",
    "CBF #521110.docx",
    "CBF #521114.docx",
    "CBF #521118.docx",
    "CBF #521124.docx",
    "CBF #521128.docx",
    "CBF #521204.docx",
    "CBF #521205.docx",
    "CBF #521208.docx",
    "CBF #521209.docx",
    "CBF #521211.docx",
    "CBF #521215.docx",
    "CBF #521218.docx",
    "CBF #521224.docx",
    "CBF #521226.docx",
    "CBF #521229.docx",
    "CBF #530102.docx",
    "CBF #530107.docx",
    "CBF #530109.docx",
    "CBF #530123.docx",
    "CBF #530126.docx",
    "CBF #530128.docx",
    "CBF #530202.docx",
    "CBF #530206.docx",
    "CBF #530213.docx",
    "CBF #530227.docx",
    "CBF #530306.docx",
    "CBF #530316.docx",
    "CBF #530320.docx",
    "CBF #530323.docx",
    "CBF #530330.docx",
    "CBF #530401.docx",
    "CBF #530409.docx",
    "CBF #530415.docx",
    "CBF #530417.docx",
    "CBF #530427.docx",
    "CBF #530518.docx",
    "CBF #530525.docx",
    "CBF #530527.docx",
    "CBF #530529.docx",
    "CBF #530608.docx",
    "CBF #530619.docx",
    "CBF #530622.docx",
    "CBF #530624.docx",
    "CBF #530629.docx",
    "CBF #530717.docx",
    "CBF #530731.docx",
    "CBF #530810.docx",
    "CBF #530812.docx",
    "CBF #530824.docx",
    "CBF #530826.docx",
    "CBF #530831.docx",
    "CBF #530902.docx",
    "CBF #530907.docx",
    "CBF #530911.docx",
    "CBF #530916.docx",
    "CBF #530925.docx",
    "CBF #530928.docx",
    "CBF #531106.docx",
    "CBF #531113.docx",
    "CBF #531123.docx",
    "CBF #531125.docx",
    "CBF #531130.docx",
    "CBF #531202.docx",
    "CBF #531204.docx",
    "CBF #531207.docx",
    "CBF #531209.docx",
    "CBF #531216.docx",
    "CBF #531218.docx",
    "CBF #531221.docx",
    "CBF #531223.docx",
    "CBF #531230.docx",
    "CBF #540113.docx",
    "CBF #540118.docx",
    "CBF #540120.docx",
    "CBF #540203.docx",
    "CBF #540205.docx",
    "CBF #540312.docx",
    "CBF #540329.docx",
    "CBF #540421.docx",
    "CBF #540618.docx",
    "CBF #540723.docx",
    "CBF #540728.docx",
    "CBF #540804.docx",
    "CBF #540903.docx",
    "CBF #540906.docx",
    "CBF #540908.docx",
    "CBF #540910.docx",
    "CBF #540913.docx",
    "CBF #540915.docx",
    "CBF #540917.docx",
    "CBF #540920.docx",
    "CBF #540922.docx",
    "CBF #540927.docx",
    "CBF #540929.docx",
    "CBF #541001.docx",
    "CBF #541004.docx",
    "CBF #541006.docx",
    "CBF #541008.docx",
    "CBF #541011.docx",
    "CBF #541013.docx",
    "CBF #541020.docx",
    "CBF #541022.docx",
    "CBF #541027.docx",
    "CBF #541103.docx",
    "CBF #541117.docx",
    "CBF #541124.docx",
    "CBF #541208.docx",
    "CBF #541215.docx",
    "CBF #550105.docx",
    "CBF #550112.docx",
    "CBF #550126.docx",
    "CBF #550202.docx",
    "CBF #550216.docx",
    "CBF #550302.docx",
    "CBF #550309.docx",
    "CBF #550316.docx",
    "CBF #550323.docx",
    "CBF #550330.docx",
    "CBF #550406.docx",
    "CBF #550413.docx",
    "CBF #550420.docx",
    "CBF #550427.docx",
    "CBF #550511.docx",
    "CBF #550518.docx",
    "CBF #550525.docx",
    "CBF #550527.docx",
    "CBF #550601.docx",
    "CBF #550615.docx",
    "CBF #550622.docx",
    "CBF #550629.docx",
    "CBF #550706.docx",
    "CBF #550713.docx",
    "CBF #550720.docx",
    "CBF #550727.docx",
    "CBF #550805.docx",
    "CBF #550812.docx",
    "CBF #550819.docx",
    "CBF #550826.docx",
    "CBF #550902.docx",
    "CBF #550909.docx",
    "CBF #550916.docx",
    "CBF #550923.docx",
    "CBF #550930.docx",
    "CBF #551014.docx",
    "CBF #551021.docx",
    "CBF #551118.docx",
    "CBF #551125.docx",
    "CBF #551202.docx",
    "CBF #551216.docx",
    "CBF #551223.docx",
    "CBF #551230.docx",
    "CBF #560106.docx",
    "CBF #560120.docx",
    "CBF #560127.docx",
    "CBF #560203.docx",
    "CBF #560217.docx",
    "CBF #560302.docx",
    "CBF #560309.docx",
    "CBF #560316.docx",
    "CBF #560323.docx",
    "CBF #560330.docx",
    "CBF #560406.docx",
    "CBF #560413.docx",
    "CBF #560420.docx",
    "CBF #560427.docx",
    "CBF #560504.docx",
    "CBF #560511.docx",
    "CBF #560518.docx",
    "CBF #560525.docx",
    "CBF #560601.docx",
    "CBF #560608.docx",
    "CBF #560615.docx",
    "CBF #560622.docx",
    "CBF #560629.docx",
    "CBF #560706.docx",
    "CBF #560713.docx",
    "CBF #560720.docx",
    "CBF #560727.docx",
    "CBF #560803.docx",
    "CBF #560809.docx",
    "CBF #560817.docx",
    "CBF #560824.docx",
    "CBF #560831.docx",
    "CBF #560907.docx",
    "CBF #560914.docx",
    "CBF #560921.docx",
    "CBF #560928.docx",
    "CBF #561005.docx",
    "CBF #561012.docx",
    "CBF #561019.docx",
    "CBF #561026.docx",
    "CBF #561102.docx",
    "CBF #561109.docx",
    "CBF #561116.docx",
    "CBF #561123.docx",
    "CBF #561130.docx",
    "CBF #561207.docx",
    "CBF #561214.docx",
    "CBF #561228.docx",
    "CBF #570104.docx",
    "CBF #570118.docx",
    "CBF #570125.docx",
    "CBF #570201.docx",
    "CBF #570208.docx",
    "CBF #570222.docx",
    "CBF #570301.docx",
    "CBF #570315.docx",
    "CBF #570322.docx",
    "CBF #570329.docx",
    "CBF #570405.docx",
    "CBF #570412.docx",
    "CBF #570419.docx",
    "CBF #570426.docx",
    "CBF #570503.docx",
    "CBF #570510.docx",
    "CBF #570531.docx",
    "CBF #570607.docx",
    "CBF #570614.docx",
    "CBF #570621.docx",
    "CBF #570628.docx",
    "CBF #570705.docx",
    "CBF #570712.docx",
    "CBF #570719.docx",
    "CBF #570726.docx",
    "CBF #570809.docx",
    "CBF #570816.docx",
    "CBF #570823.docx",
    "CBF #570830.docx",
    "CBF #570906.docx",
    "CBF #570913.docx",
    "CBF #570927.docx",
    "CBF #571004.docx",
    "CBF #571011.docx",
    "CBF #571018.docx",
    "CBF #571025.docx",
    "CBF #571108.docx",
    "CBF #571115.docx",
    "CBF #571206.docx",
    "CBF #571213.docx",
    "CBF #571220.docx",
    "CBF #571227.docx",
    "CBF #580103.docx",
    "CBF #580110.docx",
    "CBF #580131.docx",
    "CBF #580207.docx",
    "CBF #580214.docx",
    "CBF #580228.docx",
    "CBF #580307.docx",
]

def to_month(filename: str) -> str:
    fn = filename.casefold()
    if "jan" in fn:
        return "01"
    elif "feb" in fn:
        return "02"
    elif "mar" in fn:
        return "03"
    elif "apr" in fn:
        return "04"
    elif "may" in fn:
        return "05"
    elif "jun" in fn:
        return "06"
    elif "jul" in fn:
        return "07"
    elif "aug" in fn:
        return "08"
    elif "sep" in fn:
        return "09"
    elif "oct" in fn:
        return "10"
    elif "nov" in fn:
        return "11"
    elif "dec" in fn:
        return "12"
    raise Exception("no month found")

def parse_date(filename: str) -> tuple[str, str, str]:
    # year = filename[-9:-5]
    # day = filename[-13:-11]
    # day = day if day[0] != " " else f"0{day[1]}"
    # month = to_month(filename)
    # return (year, str(month), day)
    # CBF #520221.docx
    year = filename[5:7]
    month = filename[7:9]
    day = filename[9:11]
    return (year, month, day)

if __name__ == '__main__':
    for f in sorted(files, key=parse_date):
        year, month, day = parse_date(f)
        print(f'python3 ./ingest_docx.py --date {year}{month}{day} --docx "{path}{f}"')
